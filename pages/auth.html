<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sign Up / Login ‚Äî Hirelance</title>
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <!-- AOS -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .role-card:hover { transform: translateY(-4px); box-shadow: 0 6px 16px -2px rgba(139, 92, 246, 0.25); }
    .role-selected { border-color: #8b5cf6; background-color: #f3f4ff; }
  </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-pink-50 min-h-screen flex flex-col">

  <!-- Navbar -->
  <nav class="bg-white shadow-sm py-4 px-6 flex justify-between items-center">
    <div class="flex items-center space-x-2">
      <i class='bx bxl-discord text-purple-600 text-2xl'></i>
      <h1 class="text-xl font-bold text-purple-700">Hirelance</h1>
    </div>
    <a href="index.html" class="text-purple-600 hover:underline font-medium">‚Üê Home</a>
  </nav>

  <!-- Main -->
  <main class="flex-grow flex items-center justify-center px-4 py-8">
    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-xl overflow-hidden" data-aos="fade-up">
      <div class="md:flex">
        <!-- Left: Info -->
        <div class="md:w-2/5 bg-gradient-to-br from-purple-600 to-pink-600 text-white p-8 hidden md:flex flex-col justify-center items-center text-center">
          <i class='bx bx-shield-alt text-6xl mb-6'></i>
          <h2 class="text-2xl font-bold mb-3">Privacy by Default</h2>
          <p class="opacity-90 text-sm">
            Your encryption keys are generated in your browser. We never see your messages.
          </p>
        </div>

        <!-- Right: Form -->
        <div class="md:w-3/5 p-6 sm:p-8">
          <div class="text-center mb-6">
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Welcome to Hirelance</h1>
            <p class="text-gray-600 mt-2">Tech-only. Secure. Verified.</p>
          </div>

          <!-- Role Selection -->
          <div class="mb-6">
            <p class="text-gray-700 mb-3 text-center font-medium">I am a...</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="role-card border-2 border-gray-200 rounded-xl p-4 text-center cursor-pointer transition" data-role="client">
                <i class='bx bx-building text-3xl text-purple-600 mb-2'></i>
                <h3 class="font-semibold text-gray-800">Client</h3>
              </div>
              <div class="role-card border-2 border-gray-200 rounded-xl p-4 text-center cursor-pointer transition" data-role="freelancer">
                <i class='bx bx-code-alt text-3xl text-purple-600 mb-2'></i>
                <h3 class="font-semibold text-gray-800">Freelancer</h3>
              </div>
            </div>
          </div>

          <!-- Auth Form -->
          <form id="authForm" class="space-y-4">
            <input type="hidden" id="userRole" required>
            <div>
              <input type="email" id="email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="Email">
            </div>
            <div>
              <input type="password" id="password" required minlength="6" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="Password (min 6 chars)">
            </div>
            <button type="submit" class="w-full py-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition">
              Continue
            </button>
          </form>

          <!-- Divider -->
          <div class="relative flex items-center justify-center my-6">
            <div class="border-t border-gray-300 w-full absolute"></div>
            <span class="bg-white px-3 text-gray-500 text-sm">Or continue with</span>
          </div>

          <!-- Social Login -->
          <div class="space-y-3">
            <button id="googleLogin" class="w-full flex items-center justify-center space-x-3 border border-gray-300 py-2.5 rounded-lg hover:bg-gray-50">
              <i class='bx bxl-google text-red-500 text-xl'></i>
              <span>Sign in with Google</span>
            </button>
            <button id="githubLogin" class="w-full flex items-center justify-center space-x-3 border border-gray-300 py-2.5 rounded-lg hover:bg-gray-50">
              <i class='bx bxl-github text-gray-800 text-xl'></i>
              <span>Sign in with GitHub</span>
            </button>
          </div>

          <p class="text-center text-gray-600 text-sm mt-6">
            Already have an account? 
            <a href="#" id="toggleAuth" class="text-purple-600 font-medium">Switch to Login</a>
          </p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="py-4 text-center text-gray-600 text-sm">
    ¬© 2025 Hirelance by Mikky Technology
  </footer>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <script>
    // üëá REPLACE WITH YOUR FIREBASE CONFIG
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // DOM Elements
    const roleCards = document.querySelectorAll('[data-role]');
    const userRoleInput = document.getElementById('userRole');
    const authForm = document.getElementById('authForm');
    const toggleAuthLink = document.getElementById('toggleAuth');
    const googleBtn = document.getElementById('googleLogin');
    const githubBtn = document.getElementById('githubLogin');

    let isLoginMode = false;
    let selectedRole = null;

    // Role Selection
    roleCards.forEach(card => {
      card.addEventListener('click', () => {
        roleCards.forEach(c => c.classList.remove('role-selected'));
        card.classList.add('role-selected');
        selectedRole = card.dataset.role;
        userRoleInput.value = selectedRole;
      });
    });

    // Toggle between Sign Up / Login
    toggleAuthLink.addEventListener('click', (e) => {
      e.preventDefault();
      isLoginMode = !isLoginMode;
      toggleAuthLink.textContent = isLoginMode 
        ? 'Switch to Sign Up' 
        : 'Switch to Login';
      authForm.querySelector('button').textContent = isLoginMode ? 'Log In' : 'Sign Up';
    });

    // Generate encryption key (simulated)
    function generateEncryptionKey() {
      const array = new Uint8Array(32);
      crypto.getRandomValues(array);
      return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
    }

    // Save user profile to Firestore
    async function saveUserProfile(user, role) {
      const publicKey = generateEncryptionKey(); // Simulated public key
      await db.collection('users').doc(user.uid).set({
        uid: user.uid,
        email: user.email,
        role: role,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        publicKey: publicKey,
        emailBackupEnabled: false
      }, { merge: true });
    }

    // Email/Password Auth
    authForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!selectedRole && !isLoginMode) {
        alert('Please select your role.');
        return;
      }

      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      try {
        let userCredential;
        if (isLoginMode) {
          userCredential = await auth.signInWithEmailAndPassword(email, password);
        } else {
          userCredential = await auth.createUserWithEmailAndPassword(email, password);
          await saveUserProfile(userCredential.user, selectedRole);
        }

        // Redirect based on role
        const userDoc = await db.collection('users').doc(userCredential.user.uid).get();
        const role = userDoc.data()?.role || 'freelancer';
        window.location.href = role === 'client' ? 'dashboard-client.html' : 'dashboard-freelancer.html';

      } catch (error) {
        console.error(error);
        alert(error.message || 'Authentication failed.');
      }
    });

    // Google Sign-In
    googleBtn.addEventListener('click', async () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      try {
        const result = await auth.signInWithPopup(provider);
        if (!isLoginMode) {
          // New user ‚Äî prompt for role (simplified: default to freelancer)
          await saveUserProfile(result.user, selectedRole || 'freelancer');
        }
        const userDoc = await db.collection('users').doc(result.user.uid).get();
        const role = userDoc.data()?.role || 'freelancer';
        window.location.href = role === 'client' ? 'dashboard-client.html' : 'dashboard-freelancer.html';
      } catch (error) {
        console.error(error);
        alert('Google sign-in failed.');
      }
    });

    // GitHub Sign-In
    githubBtn.addEventListener('click', async () => {
      const provider = new firebase.auth.GithubAuthProvider();
      try {
        const result = await auth.signInWithPopup(provider);
        if (!isLoginMode) {
          await saveUserProfile(result.user, selectedRole || 'freelancer');
        }
        const userDoc = await db.collection('users').doc(result.user.uid).get();
        const role = userDoc.data()?.role || 'freelancer';
        window.location.href = role === 'client' ? 'dashboard-client.html' : 'dashboard-freelancer.html';
      } catch (error) {
        console.error(error);
        alert('GitHub sign-in failed.');
      }
    });

    // Initialize AOS
    AOS.init({ duration: 800, once: true });
  </script>
</body>
</html>